	SUBROUTINE SORTD(A,NAME,N,KM)
c Sorts into ascending order.
C VERSION OF SHSRTD IN WHICH DECLARED DIMENSION OF ARRAYS (=KM)
C IS GIVEN AS A PARAM. N=NO OF VALUES TO BE SORTED
C DOUBLE PRECISION VERSION OF SHSRT1
	IMPLICIT DOUBLE PRECISION (A-H,O-Z)
	dimension A(km),name(km)
c	DIMENSION A(KM)
c	INTEGER NAME(KM)
C	FORTRAN TRANSLATION OF SHELLSORT (D.C. 28-JUN-77)
C	VERSION THAT SORTS INTEGER ARRAY (E.G.EXAM NUMBER OR NAME)
C	IN SAME ORDER AS ARRAY A
C
cD	TYPE *,' IN SORTD1'
C WITH RT11 V3 THE NEXT LOOP GIVES INFINITE LOOP WITH I=1
C	DO 1 I=1,N,I
C1	M=2*I-1
C SHOULD GET I=1,2,4,8,16...
C NEXT BIT DOES SEEM TO WORK
	I1=1
	DO 1 I=1,N,I1
cD	TYPE *,I
	I1=I
1	M=2*I-1
cD	TYPE *,' M IN SORT= ',M
C
2	M=M/2
	IF(M.EQ.0) GOTO 3
	K=N-M
	DO 4 J=1,K
	DO 5 I=J,1,-M
	IF(A(I+M).GE.A(I)) GOTO 4
	W=A(I)
	A(I)=A(I+M)
	A(I+M)=W
	IN=NAME(I)
	NAME(I)=NAME(I+M)
	NAME(I+M)=IN
5	CONTINUE	!I LOOP
4	CONTINUE	!J LOOP
	GOTO 2		!M LOOP
3	CONTINUE
	RETURN
	END
