	FUNCTION ERFS(XS)
C
C ERFS(X)=SINGLE PRECISION VERSION OF ERF(X). X AND ERFS(X) ARE
C SINGLE PRECISION BUT STILL DOUBLE PREC INTERNALLY
C FROM NAGLIB MARK 8.
	REAL*8 ERF,XUP,SQRTPI,ZERO,ONE,TWO,THREE,TWENTY,HALF,
     &	XV,X2,BJP2,BJP1,BJ
	REAL*8 C(18),D(17)
C
C DATA IS MAX ACCURACY OF THE OPTIONS IN THE ORIGINAL
	DATA NCFC,NCFD/18,17/,XUP/6.25D0/,SQRTPI/1.7724538509055160D0/
     &	C/1.9949071068178803D0,4.20186582324414D-2,-1.86866103976769D-2,
     &	5.1281061839107D-3,-1.0683107461726D-3,1.744737872522D-4,
     &	-2.15642065714D-5,1.7282657974D-6,-2.00479241D-8,
     &	-1.64782105D-8,2.0008475D-9,2.57716D-11,-3.06343D-11,
     &	1.9158D-12,3.703D-13,-5.43D-14,-4.0D-15,1.2D-15/,
     &	D/1.4831105640848036D0,-3.010710733865950D-1,6.89948306898316D-2,
     &	-1.39162712647222D-2,2.4207995224335D-3,-3.658639685849D-4,
     &	4.86209844323D-5,-5.7492565580D-6,6.113243578D-7,
     &	-5.89910153D-8,5.2070091D-9,-4.232976D-10,3.18811D-11,
     &	-2.2361D-12,1.467D-13,-9.0D-15,5.0D-16/
C
	DATA ZERO,ONE,TWO,THREE,TWENTY,HALF/0.D0,1.D0,2.D0,3.D0,
     &	20.D0,.5D0/
C
	X=DBLE(XS)
	XV=DABS(X)
	IF(XV.GE.XUP) GOTO 120
	IF(XV.LE.TWO) GOTO 60
	X2=TWO-TWENTY/(XV+THREE)
C
	BJP2=ZERO
	BJP1=C(NCFC)
	J=NCFC-1
20	BJ=X2*BJP1-BJP2+C(J)
	IF(J.EQ.1) GOTO 40
	BJP2=BJP1
	BJP1=BJ
	J=J-1
	GOTO 20
40	X2=HALF*(BJ-BJP2)/XV*DEXP(-X*X)/SQRTPI
	ERF=(ONE-X2)*DSIGN(ONE,X)
	GOTO 140
C
60	X2=X*X-TWO
	BJP2=ZERO
	BJP1=D(NCFD)
	J=NCFD-1
80	BJ=X2*BJP1-BJP2+D(J)
	IF(J.EQ.1) GOTO 100
	BJP2=BJP1
	BJP1=BJ
	J=J-1
	GOTO 80
100	ERF=HALF*(BJ-BJP2)*X
	GOTO 140
C
120	ERF=DSIGN(ONE,X)
140	ERFS=SNGL(ERF)
	RETURN
	END

