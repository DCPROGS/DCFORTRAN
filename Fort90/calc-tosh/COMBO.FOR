	subroutine COMBO(IR,N,ICOMB,NCOMB)
C
C TO TABULATE ALL IR-TUPLETS OUT OF N
C IR=1,...,9; N UP TO 10 (SO WON'T DO IR=10,N=10)
C IR=1,...,7; N UP TO 8 (SO WON'T DO IR=8,N=8)
C ICOMB(I,J)=I'TH COMBINATION I=1,...,N!/R!(N-R)!
C	     J=1,...,IR
C OUTPUTS NCOMB
C
	INTEGER ICOMB(90,9),IC(10)
C
C
	IF(IR.LT.1.OR.IR.GT.9.OR.N.GT.10) print 300,IR,N
300	FORMAT( ' ****ARGS FOR COMBO OUT OF RANGE. IR,N= ',2I4)
	K=0
	K2=N-IR+1
C
	DO 1 J1=1,K2
	IC(1)=J1	!SAVE FOR ALLOC WHEN IR'TH LOOP REACHED
C   NEXT BIT DONE WHEN IR1=IR. ALLOCATE A COMBO AND SKIP INNER LOOPS.
	IF(IR.EQ.1) CALL ALLOC(ICOMB,IC,K,1)
	IF(IR.EQ.1) GOTO 1
C
	DO 2 J2=J1+1,K2+1
	IC(2)=J2
	IF(IR.EQ.2) CALL ALLOC(ICOMB,IC,K,2)
	IF(IR.EQ.2) GOTO 2
C
	DO 3 J3=J2+1,K2+2
	IC(3)=J3
	IF(IR.EQ.3) CALL ALLOC(ICOMB,IC,K,3)
	IF(IR.EQ.3) GOTO 3
C
	DO 4 J4=J3+1,K2+3
	IC(4)=J4
	IF(IR.EQ.4) CALL ALLOC(ICOMB,IC,K,4)
	IF(IR.EQ.4) GOTO 4
C
	DO 5 J5=J4+1,K2+4
	IC(5)=J5
	IF(IR.EQ.5) CALL ALLOC(ICOMB,IC,K,5)
	IF(IR.EQ.5) GOTO 5
C
	DO 6 J6=J5+1,K2+5
	IC(6)=J6
	IF(IR.EQ.6) CALL ALLOC(ICOMB,IC,K,6)
	IF(IR.EQ.6) GOTO 6
C
	DO 7 J7=J6+1,K2+6
	IC(7)=J7
	IF(IR.EQ.7) CALL ALLOC(ICOMB,IC,K,7)
	IF(IR.EQ.7) GOTO 7
C
	DO 8 J8=J7+1,K2+7
	IC(8)=J8
	IF(IR.EQ.8) CALL ALLOC(ICOMB,IC,K,8)
	IF(IR.EQ.8) GOTO 8
c
	DO 9 J9=J8+1,K2+8
	IC(9)=J9
	IF(IR.EQ.9) CALL ALLOC(ICOMB,IC,K,9)
	IF(IR.EQ.9) GOTO 9
c
	DO 10 J10=J9+1,K2+9
	IC(10)=J10
	IF(IR.EQ.10) CALL ALLOC(ICOMB,IC,K,10)
c	IF(IR.EQ.10) GOTO 10
C
10	CONTINUE
9	CONTINUE
8	CONTINUE
7	CONTINUE
6	CONTINUE
5	CONTINUE
4	CONTINUE
3	CONTINUE
2	CONTINUE
1	CONTINUE
C
	NCOMB=K
c	NCOMB=IFIX(0.5 + FACT(N)/(FACT(IR)*FACT(N-IR)))
c	print 110,K,NCOMB
c110	FORMAT( ' K,NCOMB= ',2I8)
c	DO 120 I=1,NCOMB
c120	print 130,I,(ICOMB(I,J),J=1,IR)
c130	FORMAT(I5,2X,8I8)
c
	RETURN
	END





c	FUNCTION FACT(N)
C
C RETURNS FACTORIAL N AS FLOATING POINT NUMBER
c	F=1
c	IF(N.EQ.1) GOTO 2
c	DO 1 I=2,N
c1	F=F*FLOAT(I)
c2	FACT=F
c	RETURN
c	END



C
	SUBROUTINE ALLOC(ICOMB,IC,K,IR1)
	INTEGER ICOMB(90,9),IC(10)
	K=K+1
	DO 1 J=1,IR1		!ALLOCATE A COMBO
	ICOMB(K,J)=IC(J)	!WITH IC() FROM ALL OUTER LOOPS
C	print 200,IR1,K,J,ICOMB(K,J)
C200	FORMAT(4I8)
1	CONTINUE
	RETURN
	END



