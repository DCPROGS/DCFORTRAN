	subroutine MATSCL1(PHI,Q,END,kr,kc,SCAL,KP,KQ,KE)
C MATSCL1 is like MATSCL except that Q need not be square
c phi=1*kr  Q=kr*kc  end=kc*1
C CONVERTS MATRIX Q (k X k) TO A SCALAR BY PREMULTIPLYING
C BY VECTOR PHI ( 1 X k) AND POSTMULTIPLYING BY VECTOR
C END (k X 1). RESULT IN SCAL.
C	KP= DECLARED DIM OF PHI(1,KP)
C	KQ= DECLARED DIM OF Q(KQ,KQ)
C	KE= DECLARED DIM OF END(KE,1)
C
	REAL*8 PHI(1,KP),Q(KQ,KQ),END(KE,1),SCAL,ZERO
	REAL*8 T
C
	ZERO=0.0D0
	SCAL=ZERO
	DO 1 I=1,kr
	T=ZERO
	DO 2 J=1,kc
	T=T+Q(I,J)*END(J,1)	!ACCUM ITH ELEMENT OF Q*END
c	print 3,I,J,Q(I,J),END(J,1)
c3	FORMAT(2I5,2G13.6)
2	CONTINUE
	SCAL=SCAL+PHI(1,I)*T
c	print 4,I,PHI(1,I),SCAL
c4	FORMAT(' I,PHI(I),S= ',I8,2G13.6)
1	CONTINUE
	RETURN
	END


